\section{Johdanto}

Pistepilveksi kutsutaan suurta joukkoa pisteitä kolmiulotteisessa avaruudessa, jolla kuvataan esineiden, rakennusten tai maisemien pinnanmuotoja. Pistepilvi tuotetaan yleensä laserkeilaimella \engl{laser scanner}, joka ampuu ympärilleen laserpurskeita ja mittaa etäisyyksiä pisteisiin, joista purske heijastuu takaisin. Katvealueiden välttämiseksi suoritetaan useita laserkeilauksia mitattavan kohteen ympäriltä. Laserkeilaimet mittaavat pisteitä niin tiheästi, että keilauksen lopputuloksena saadut pisteet näyttävät muodostavan yhtenäisiä pintoja. 

Pistepilviä voidaan tuottaa myös synteettisesti mistä tahansa 3d-mallista. Yksinkertaisimmillaan kolmioverkosta voidaan unohtaa kärkipisteiden liitäntätieto, ja käyttää vain kärkipisteiden muodostamaa joukkoa kuvaamaan mallia. 1980-luvulta lähtien pisteitä on ehdotettu yleisiksi piirtoprimitiiveiksi kuvaamaan mitä tahansa geometriaa \cite{Whitted}. Ajatus on nykyään vielä ajankohtaisempi, sillä visualisoitavat mallit monimutkaistuvat jatkuvasti ja usein yksittäiset kolmiot projisoituvat kuvaruudulle alle pikselin kokoisina. Tällöin kolmion kärkipisteiden sijaan olisi tehokkaampaa säilyttää muistissa vain yhtä pistettä ja sen normaalivektoria. Grafiikkakirjastot ja näytönohjaimet on kuitenkin vielä optimoitu kolmioiden käsittelyyn.

Pistepilvillä kuvataan hyvin erikokoisia kohteita yksittäisistä esineistä kokonaisiin valtioihin ja niitä käytetään esimerkiksi kuluttajatuotteiden suunnittelussa, rakentamisessa ja maanmittauksessa. Laserkeilauksen etu muihin mittaustekniikoihin on sen nopeus ja helppous: muutamalla keilaimen pyörähdyksellä saadaan taltioitua kokonainen huone millimetritarkkuudella. Laserkeilauksen jälkeen pistepilviä pitää usein esikäsitellä ennen kuin niitä voi käyttää suunnittelu- tai katseluohjelmistoissa. Näitä esikäsittelyvaiheita ovat muun muassa rekisteröinti, normaalivektorien etsiminen ja häiriönpoisto. Joitakin esimerkkejä pistepilvien sovelluskohteista ja esikäsittelyvaiheista on esitetty luvussa \ref{pistepilvet}.

Keilauksen kohteesta riippuen tarvitaan yleensä miljoonia tai jopa miljardeja pisteitä, jotta saavutettaisiin tarpeeksi tiheä näytteistys. Pisteiden valtava määrä johtaa haasteisiin niitä käsittelevissä ja visualisoivissa ohjelmistoissa. Pistepilviä sisältävät tiedostot voivat olla niin suuria, etteivät ne mahdu kerralla keskusmuistiin. Toinen ongelma on suuren pistepilven visualisointiin vaadittu aika. Jos halutaan säilyttää korkea ruudunpäivitystaajuus, ei koko pistepilveä voida piirtää jokaiselle ruudulle. Luvussa \ref{kirjallisuus} etsitään näihin ongelmiin ratkaisuja alan kirjallisuudesta. Useimmat ratkaisuehdotukset käsittelevät hierarkisia tietorakenteita ja algoritmeja, jotka mahdollistavat pistepilvien asteittaisen lataamisen ja visualisoinnin. Näistä tietorakenteista valitaan tarkempaa tarkastelua varten sellainen, joka sopii laitossuunnitteluohjelmiston tarpeisiin. 

Laitossunnitteluohjelmistoissa käytetään pistepilviä yleensä muutostöiden yhteydessä, kun laitoksesta halutaan saada ajan tasalla oleva 3d-malli. Nämä pistepilvet vaihtelevat kooltaan yhdestä huoneesta kokonaisiin tehdasalueisiin. Laitossuunnitteluohjelmistossa käytettävän pistepilvivisualisoijan on kyettävä pistepilven koosta riippumatta visualisoimaan reaaliaikaisella ruudunpäivitystaajuudella sekä yksityiskohtia läheltä katsellessa, että yleiskuva katselupisteen ollessa kauempana. Pistepilven tarkkuus ei saa kärsiä, sillä ohjelmistoa käyttävän suunnittelijan täytyy voida tehdä mittauksia pisteiden välillä. Luvussa \ref{mun} esitellään tekniikoita, joilla kirjallisuuden pohjalta valittua tietorakennetta, niin kutsuttua sisäkkäispistepuuta hyödynnetään ja miten pisteiden esitysmuotoa muuttamalla saadaan pistepilveä kompressoitua. Luvussa \ref{tulokset} arvioidaan tietorakenteen ja kompression vaikutusta pistepilvivisualisoijan suorituskykyyn. Lopuksi luvussa \ref{jatko} mainitaan muutamia tietorakennetta testattaessa havaittuja ongelmia ja jatkotutkimusaiheita.

Tämä tutkielma on tehty CADMATIC Oy:n toimeksiantona. CADMATIC on suomalainen ohjelmistoyritys, joka kehittää tuotteita laivojen ja laitosten tietokoneavusteiseen suunnitteluun. CADMATIC on toiminut alalla 1980-luvulta lähtien ja sillä on asiakkainaan yli tuhat organisaatiota yli viidestäkymmenestä maasta \cite{cadmatic}. Yrityksen pääkonttori on Turussa. Tutkielmassa kehitettävää tietorakennetta testataan CADMATIC Plant Modeller -laitossuunnitteluohjelmistossa, sekä eBrowser-mallinkatseluohjelmistossa. 